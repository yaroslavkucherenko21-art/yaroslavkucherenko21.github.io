<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>3D Земля</title>

<style>
body {
  margin: 0;
  overflow: hidden;
  font-family: Arial, sans-serif;
  background: black;
}

#ui {
  position: absolute;
  top: 20px;
  left: 20px;
  z-index: 10;
}

button {
  padding: 10px 16px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  background: #1e88e5;
  color: white;
}

#info {
  position: absolute;
  bottom: 20px;
  left: 20px;
  max-width: 320px;
  background: rgba(0,0,0,0.7);
  padding: 15px;
  border-radius: 12px;
  display: none;
}
</style>
</head>

<body>

<div id="ui">
  <button onclick="toggleLight()">День / Ніч</button>
</div>

<div id="info"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<script>
let scene = new THREE.Scene();

let camera = new THREE.PerspectiveCamera(
  60,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
);
camera.position.z = 3;

let renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Світло
let light = new THREE.PointLight(0xffffff, 1.3);
light.position.set(5, 3, 5);
scene.add(light);

// Текстура Землі
let textureLoader = new THREE.TextureLoader();

let earthTexture = textureLoader.load(
  "https://threejs.org/examples/textures/land_ocean_ice_cloud_2048.jpg"
);

let earthGeometry = new THREE.SphereGeometry(1, 64, 64);

let earthMaterial = new THREE.MeshPhongMaterial({
  map: earthTexture
});

let earth = new THREE.Mesh(earthGeometry, earthMaterial);
scene.add(earth);

// Атмосфера
let glowGeometry = new THREE.SphereGeometry(1.05, 64, 64);

let glowMaterial = new THREE.MeshBasicMaterial({
  color: 0x3399ff,
  transparent: true,
  opacity: 0.25
});

let glow = new THREE.Mesh(glowGeometry, glowMaterial);
scene.add(glow);

// Маркер (Гренландія)
let markerGeo = new THREE.SphereGeometry(0.03, 16, 16);
let markerMat = new THREE.MeshBasicMaterial({ color: 0xff0000 });
let marker = new THREE.Mesh(markerGeo, markerMat);

// Координати Гренландії
let lat = 72;
let lon = -40;

let phi = (90 - lat) * Math.PI / 180;
let theta = (lon + 180) * Math.PI / 180;

marker.position.x = -Math.sin(phi) * Math.cos(theta);
marker.position.y = Math.cos(phi);
marker.position.z = Math.sin(phi) * Math.sin(theta);

earth.add(marker);

// Клік по маркеру
let raycaster = new THREE.Raycaster();
let mouse = new THREE.Vector2();

window.addEventListener("click", (event) => {
  mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
  mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

  raycaster.setFromCamera(mouse, camera);
  let intersects = raycaster.intersectObjects([marker]);

  if (intersects.length > 0) {
    let info = document.getElementById("info");
    info.style.display = "block";
    info.innerHTML =
      "<h3>Гренландія</h3>" +
      "<p>Найбільший острів у світі.</p>" +
      "<p>Належить Данії.</p>" +
      "<p>Приблизно 80% території вкрито льодом.</p>";
  }
});

// День/ніч
let day = true;

function toggleLight() {
  day = !day;
  light.intensity = day ? 1.3 : 0.15;
  glow.material.opacity = day ? 0.25 : 0.05;
}

// Обертання + керування мишкою
let isDragging = false;

document.addEventListener("mousedown", () => isDragging = true);
document.addEventListener("mouseup", () => isDragging = false);

document.addEventListener("mousemove", (e) => {
  if (isDragging) {
    earth.rotation.y += e.movementX * 0.005;
    earth.rotation.x += e.movementY * 0.005;
  }
});

// Анімація
function animate() {
  requestAnimationFrame(animate);
  earth.rotation.y += 0.0008;
  renderer.render(scene, camera);
}

animate();

// Адаптація під екран
window.addEventListener("resize", () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>
